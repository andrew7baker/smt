<html>
    <head>
        <!-- 简洁查询页面 -->
        <!--<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">-->
        <meta charset="utf-8">

        <title>生产监控</title>
        <link rel="stylesheet" href="../js/layui/css/layui.css"  media="all">
        <script src="../js/layui/layui.js" charset="utf-8"></script>
        <script src="../handsontable/dist/handsontable.full.min.js"></script>
        <link type="text/css" rel="stylesheet" href="../handsontable/dist/handsontable.full.min.css">
        <script type="text/javascript" src="../js/util/cookie.js"></script>
    </head>
    <body>
    <div style="padding: 20px; background-color: #F2F2F2;">
        <div class="layui-row layui-col-space15">
            <div class="layui-col-md12">
                <div class="layui-card">
                    <div class="layui-card-header">
                        <form class="layui-form toolbar"  action="">
                            <div class="layui-form toolbar">
                                <div class="layui-form-item">
                                    <div class="layui-inline">
                                        <input id="condition" class="layui-input" type="text" placeholder="名称/编码" autocomplete="off">
                                    </div>
                                    <div class="layui-inline">
                                        <select id="systemFlag">
                                            <option value="">机器编号</option>
                                            <option value="1">A线</option>
                                            <option value="2">B线</option>
                                            <option value="3">C线</option>
                                        </select><div class="layui-unselect layui-form-select"><div class="layui-select-title"><input type="text" placeholder="机器编号" value="" readonly="" class="layui-input layui-unselect"><i class="layui-edge"></i></div><dl class="layui-anim layui-anim-upbit"><dd lay-value="" class="layui-select-tips">机器编号</dd><dd lay-value="Y" class="">系统类型</dd><dd lay-value="N" class="">非系统类型</dd></dl></div>
                                    </div>
                                    <div class="layui-inline">
                                        <button id="load" class="layui-btn layui-btn-normal"><i class="layui-icon"></i>搜索</button>
                                        <button id="btnAdd" class="layui-btn icon-btn"><i class="layui-icon"></i>添加类型</button>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="layui-card-body">
                        <div id="example1" class="hot handsontable htColumnHeaders"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        layui.use(['form'], function(){
            var $ = layui.jquery
                ,form = layui.form;
        });
    </script>

        <script>
            function ajax(url, method, params, callback) {
                var obj;

                try {
                    obj = new XMLHttpRequest();
                } catch (e) {
                    try {
                        obj = new ActiveXObject("Msxml2.XMLHTTP");
                    } catch (e) {
                        try {
                            obj = new ActiveXObject("Microsoft.XMLHTTP");
                        } catch (e) {
                            alert("Your browser does not support Ajax.");
                            return false;
                        }
                    }
                }
                obj.onreadystatechange = function () {
                    if (obj.readyState == 4) {
                        callback(obj);
                    }
                };
                obj.open(method, url, true);
                obj.setRequestHeader("X-Requested-With", "XMLHttpRequest");
                obj.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                obj.send(params);
                return obj;
            }

            var data = [];
            document.addEventListener("DOMContentLoaded", function () {
                var
                    container = document.getElementById('example1'),
                    hot;

                hot = new Handsontable(container, {
                    data: data,
                    renderAllRows: true,
                    rowHeaders: true,
                    colHeaders: [
                        'ID',
                        'VERSION',
                        'Power Time',
                        'Place Time',
                        'Wait Time',
                        'Run Time',
                        'Stop Time',
                        'Idle Time',
                        'In Wait Time',
                        'Out Wait Time',
                        'Trans Time',
                        'Wrong Stop Time',
                        'Error Stop Time',
                        'Wrong Stop Count',
                        'Error Stop Count',
                        'Panel In Count',
                        'Panel Out Count',
                        'Panel Count',
                        'PCB Count',
                        'error_pcb',
                        'Skip PCB Count',
                        'Operation Rate',
                        'Placement Rate',
                        'Mean Time/PCB',
                        'Real Time/PCB',
                        'Transfer Time/PCB',
                        'Place Count',
                        '效率'
                    ]
                });

                var rows=hot.countRows();  // get the count of the rows in the table
                var cols=hot.countCols();  // get the count of the columns in the table.
                hot.render();
                loadData();
                // 点击加载
                Handsontable.dom.addEvent(load, 'click', function() {
                    loadData();
                })

                /**
                 * 加载列表数据
                 */
                function loadData() {
                    ajax(rooturl+'/api/bmt-chang-ci-report/getSmtList', 'GET', '', function(res) {
                        var data = JSON.parse(res.response);
                        hot.loadData(data.data);
                    });
                }
            });
        </script>
    </body>
</html>
