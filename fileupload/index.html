<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
        <title>Spring Boot File Upload / Download Rest API Example</title>
        <link rel="stylesheet" href="../js/layui/css/layui.css"  media="all">
        <script src="../js/layui/layui.js" charset="utf-8"></script>

        <script src="../handsontable/dist/handsontable.full.min.js"></script>
        <link type="text/css" rel="stylesheet" href="../handsontable/dist/handsontable.full.min.css">

        <link rel="stylesheet" type="text/css" href="../js/jquery-easyui-1.7.0/themes/default/easyui.css">
        <link rel="stylesheet" type="text/css" href="../js/jquery-easyui-1.7.0/themes/icon.css">
        <!--<link rel="stylesheet" type="text/css" href="../js/jquery-easyui-1.7.0/demo/demo.css">-->
        <script type="text/javascript" src="../js/jquery-easyui-1.7.0/jquery.min.js"></script>
        <script type="text/javascript" src="../js/jquery-easyui-1.7.0/jquery.easyui.min.js"></script>
        <script type="text/javascript" src="../js/echarts-4.1.0/echarts.min.js"></script>

    </head>
    <body>

        <div class="layui-upload">
            <button type="button" class="layui-btn layui-btn-normal" id="test8">选择文件</button>
            <button type="button" class="layui-btn" id="test9">开始上传</button>
        </div>
        <div class="layui-tab">
            <ul class="layui-tab-title">
                <li class="layui-this">生产数据</li>
            </ul>
            <div class="layui-tab-content">
                <div class="layui-row">
                    <div class="layui-container">

                        <div class="easyui-layout" style="width:1100px;height:550px;">

                            <div data-options="region:'east',split:true" title="East" style="width:380px;">
                                <div id="chart-container"></div>
                            </div>
                            <div data-options="region:'center',iconCls:'icon-ok'" title="F线主机" style="padding:5px">
                                <div class="easyui-layout" data-options="fit:true">
                                    <div data-options="region:'north',split:true" style="height:50px"></div>
                                    <div data-options="region:'west',split:true" style="width:100px"></div>
                                    <div data-options="region:'center'">
                                        <div id="example1" class="hot handsontable htColumnHeaders"></div>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <div class="layui-col-xs6">
                            <div class="grid-demo grid-demo-bg1"><div class="layui-tab-item layui-show">

                            </div></div>
                        </div>

                    </div>
                </div>



            </div>
        </div>



    <script>
        layui.use('upload', function(){
            var $ = layui.jquery
                ,upload = layui.upload;

            //同时绑定多个元素，并将属性设定在元素上
            upload.render({
                elem: '.demoMore'
                ,before: function(){
                    layer.tips('接口地址：'+ this.url, this.item, {tips: 1});
                }
                ,done: function(res, index, upload){
                    var item = this.item;
                    console.log(item); //获取当前触发上传的元素，layui 2.1.0 新增
                }
            })

            //选完文件后不自动上传
            upload.render({
                elem: '#test8'
                ,url: 'http://localhost:8080/api/smt-file-upload/uploadFile'
                ,auto: false
                //,multiple: true
                ,bindAction: '#test9'
                ,exts:'xlsx'
                ,done: function(res){
                    console.log(res)
                }
            });
        });
    </script>

        <script>
            layui.use('element', function(){
                var $ = layui.jquery
                    ,element = layui.element;
            });
        </script>

        <script>
            var data = [
                ['设计坐标', '', '', '', '', '贴片机坐标', '', '', ''],
                ['位置号', 'X', 'Y', '角度','', '位置号', 'X', 'Y', '角度'],
                ['Q654', 135.15, 53.25, 270,'','C109', 67.301,48.153,-90],
                ['Q654', 135.15, 53.25, 270,'','C109', 67.301,48.153,-90],
                ['Q654', 135.15, 53.25, 270,'','C109', 67.301,48.153,-90],
                ['Q654', 135.15, 53.25, 270,'','C109', 67.301,48.153,-90],
                ['Q654', 135.15, 53.25, 270,'','C109', 67.301,48.153,-90],
                ['Q654', 135.15, 53.25, 270,'','C109', 67.301,48.153,-90],
                ['Q654', 135.15, 53.25, 270,'','C109', 67.301,48.153,-90],
                ['Q654', 135.15, 53.25, 270,'','C109', 67.301,48.153,-90],
                ['Q654', 135.15, 53.25, 270,'','C109', 67.301,48.153,-90],
                ['Q654', 135.15, 53.25, 270,'','C109', 67.301,48.153,-90],
                ['Q654', 135.15, 53.25, 270,'','C109', 67.301,48.153,-90],
                ['Q654', 135.15, 53.25, 270,'','C109', 67.301,48.153,-90],
                ['Q654', 135.15, 53.25, 270,'','C109', 67.301,48.153,-90],
                ['Q654', 135.15, 53.25, 270,'','C109', 67.301,48.153,-90],
                ['Q654', 135.15, 53.25, 270,'','C109', 67.301,48.153,-90]
            ];
            document.addEventListener("DOMContentLoaded", function () {
                var
                    container = document.getElementById('example1'),
                    hot;

                hot = new Handsontable(container, {
                    data: data,
                    mergeCells: [
                        {row: 0, col: 0, rowspan: 1, colspan: 4},
                        {row: 0, col: 5, rowspan: 1, colspan: 4}
                    ],
                    renderAllRows: true,
                    rowHeaders: true,
                    colHeaders: true
                });

                var rows=hot.countRows();  // get the count of the rows in the table
                var cols=hot.countCols();  // get the count of the columns in the table.
                for(var row=0; row<rows; row++){  // go through each row of the table
                    console.log("rows="+rows);
                    for(var col=0; col<cols; col++){  // go through each column of the row
                        var cell = hot.getCell(row,col);
                        cell.style.background = "##00FF00";
                    }
                }
                hot.render();
            });

            var dom = document.getElementById("container");
            var myChart = echarts.init(dom);
            var app = {};
            option = null;
            option = {
                title: {
                    text: '天气情况统计',
                    subtext: '虚构数据',
                    left: 'center'
                },
                tooltip: {
                    trigger: 'item',
                    formatter: '{a} <br/>{b} : {c} ({d}%)'
                },
                legend: {
                    // orient: 'vertical',
                    // top: 'middle',
                    bottom: 10,
                    left: 'center',
                    data: ['西凉', '益州', '兖州', '荆州', '幽州']
                },
                series: [
                    {
                        type: 'pie',
                        radius: '65%',
                        center: ['50%', '50%'],
                        selectedMode: 'single',
                        data: [
                            {
                                value: 1548,
                                name: '幽州',
                                label: {
                                    formatter: [
                                        '{title|{b}}{abg|}',
                                        '  {weatherHead|天气}{valueHead|天数}{rateHead|占比}',
                                        '{hr|}',
                                        '  {Sunny|}{value|202}{rate|55.3%}',
                                        '  {Cloudy|}{value|142}{rate|38.9%}',
                                        '  {Showers|}{value|21}{rate|5.8%}'
                                    ].join('\n'),
                                    backgroundColor: '#eee',
                                    borderColor: '#777',
                                    borderWidth: 1,
                                    borderRadius: 4,
                                    rich: {
                                        title: {
                                            color: '#eee',
                                            align: 'center'
                                        },
                                        abg: {
                                            backgroundColor: '#333',
                                            width: '100%',
                                            align: 'right',
                                            height: 25,
                                            borderRadius: [4, 4, 0, 0]
                                        },
                                        Sunny: {
                                            height: 30,
                                            align: 'left',
                                            backgroundColor: {
                                                image: weatherIcons.Sunny
                                            }
                                        },
                                        Cloudy: {
                                            height: 30,
                                            align: 'left',
                                            backgroundColor: {
                                                image: weatherIcons.Cloudy
                                            }
                                        },
                                        Showers: {
                                            height: 30,
                                            align: 'left',
                                            backgroundColor: {
                                                image: weatherIcons.Showers
                                            }
                                        },
                                        weatherHead: {
                                            color: '#333',
                                            height: 24,
                                            align: 'left'
                                        },
                                        hr: {
                                            borderColor: '#777',
                                            width: '100%',
                                            borderWidth: 0.5,
                                            height: 0
                                        },
                                        value: {
                                            width: 20,
                                            padding: [0, 20, 0, 30],
                                            align: 'left'
                                        },
                                        valueHead: {
                                            color: '#333',
                                            width: 20,
                                            padding: [0, 20, 0, 30],
                                            align: 'center'
                                        },
                                        rate: {
                                            width: 40,
                                            align: 'right',
                                            padding: [0, 10, 0, 0]
                                        },
                                        rateHead: {
                                            color: '#333',
                                            width: 40,
                                            align: 'center',
                                            padding: [0, 10, 0, 0]
                                        }
                                    }
                                }
                            },
                            {value: 535, name: '荆州'},
                            {value: 510, name: '兖州'},
                            {value: 634, name: '益州'},
                            {value: 735, name: '西凉'}
                        ],
                        emphasis: {
                            itemStyle: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                            }
                        }
                    }
                ]
            };
            if (option && typeof option === "object") {
                myChart.setOption(option, true);
            }


        </script>
    </body>
</html>
